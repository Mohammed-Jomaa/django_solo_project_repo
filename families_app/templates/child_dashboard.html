{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø·ÙÙ„</title>
    <link href="{% static 'bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" />
    <link href="{% static 'CSS/style.css' %}" rel="stylesheet" />
</head>

<body>
    <header>
        <nav class="navbar navbar-light bg-white shadow-sm">
            <div class="container d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center gap-2">
                    <img src="{% static 'images/logo.png' %}" width="40" height="40" />
                    <span class="fw-bold brand-orange fs-5">Ø¨ÙÙ†Ø§Ø© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</span>
                </div>
                <a href="{% url 'logout' %}" class="btn btn-orange">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
            </div>
        </nav>
    </header>

    <main class="container py-5 text-center">

        <div class="mb-4">
            <h3 class="fw-bold">ğŸ‘‹ Ù…Ø±Ø­Ø¨Ù‹Ø§ {{ user.first_name }} ÙÙŠ Ø¹Ø§Ø¦Ù„ØªÙƒ!</h3>
            <h5 class="text-muted mt-2">Ù†Ù‚Ø§Ø·Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©:
                <span class="fw-bold text-success">{{ points.points }}</span>
            </h5>
        </div>
        {% for message in messages %}
        {% if 'error' in message.tags %}
        <div class="alert alert-danger text-center">
            {% else %}
            <div class="alert alert-{{ message.tags }} text-center">
                {% endif %}
                {{ message }}
            </div>
            {% endfor %}


        </div>


        <section class="mb-5">
            <h5 class="fw-bold mb-4">ğŸ“‹ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</h5>
            {% if tasks %}
            <div class="row g-4">
                {% for task in tasks %}
                <div class="col-md-4">
                    <div class="card shadow-sm p-3 h-100">
                        <h6 class="fw-bold">{{ task.title }}</h6>
                        <p class="mb-2"> Ø§Ù„Ù†Ù‚Ø§Ø·: <strong>{{ task.points }}</strong></p>

                        <p class="text-muted mb-2">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…: {{ task.due_date|default:"ØºÙŠØ± Ù…Ø­Ø¯Ø¯" }}</p>
                        <a href="{% url 'submit_task' task.id %}" class="btn btn-sm btn-orange"
                            style="width: 50%; align-self: center;">ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ù‡Ù…Ø©</a>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹.</p>
            {% endif %}
        </section>

        <section>
            <h5 class="fw-bold mb-4">ğŸ Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² Ø§Ù„Ù…ØªØ§Ø­Ø©:</h5>
            <div class="row g-4">
                {% if rewards %}
                {% for reward in rewards %}
                <div class="col-md-4">
                    <div class="card shadow-sm text-center h-100 p-3">
                        {% if reward.image %}
                        <img src="{{ reward.image.url }}" class="card-img-top"
                            style="height: 180px; object-fit: contain;" alt="Ø¬Ø§Ø¦Ø²Ø©">
                        {% else %}
                        <img src="{% static 'images/gift.png' %}" class="card-img-top"
                            style="height: 180px; object-fit: contain;" alt="Ø¬Ø§Ø¦Ø²Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©">
                        {% endif %}
                        <h6 class="fw-bold mt-2">{{ reward.title }}</h6>
                        <p>Ù†Ù‚Ø§Ø·: {{ reward.points_cost }}</p>
                        {% if reward.id in claimed_reward_ids %}
                        <button class="btn btn-sm btn-success" disabled>Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø¨Ø§Ù„ÙØ¹Ù„</button>
                        {% else %}
                        <form method="POST" action="{% url 'claim_reward' reward.id %}">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-sm btn-outline-orange">Ø§Ø³ØªØ¨Ø¯Ø§Ù„</button>
                        </form>
                        {% endif %}

                    </div>
                </div>
                {% endfor %}
                {% else %}
                <p class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¬ÙˆØ§Ø¦Ø² Ø­Ø§Ù„ÙŠØ§Ù‹.</p>
                {% endif %}
            </div>
        </section>

    </main>

    <footer class="text-center text-muted py-3 mt-5">
        <a href="{% url 'about' %}">Ù…Ù† Ù†Ø­Ù†</a> | Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2025
    </footer>


    <script src="{% static 'bootstrap/js/bootstrap.bundle.min.js' %}"></script>
</body>

</html>